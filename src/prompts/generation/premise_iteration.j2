{#
    Premise iteration prompt - regenerate premise based on user feedback.

    Variables:
    - iteration_context: Full context string with feedback, history, judge feedback
    - old_content: Current premise as JSON string
    - attempt: Current attempt number
#}

[SYSTEM]
You are a professional story premise developer. You excel at refining story concepts based on feedback while maintaining narrative coherence. You always return valid JSON without additional formatting.

[USER]
You are revising a story premise based on user feedback.

{{ iteration_context }}

CURRENT PREMISE:
```json
{{ old_content }}
```

TASK:
Revise the premise to address the user's feedback while maintaining story coherence.

GUIDELINES:
1. **Address the Feedback**: Directly implement what the user requested
2. **Maintain Coherence**: Keep the premise internally consistent
3. **Preserve What Works**: Don't unnecessarily change elements not mentioned in feedback
4. **Improve Quality**: Use this as an opportunity to strengthen weak areas
5. **Respect Taxonomy**: Keep taxonomy selections unless feedback asks to change them
6. **Be Complete**: Return a full premise, not just the changed parts

RETURN FORMAT:
Return ONLY valid JSON (no markdown fences):

{
  "text": "The complete revised premise text (2-4 paragraphs, 100-300 words)",
  "taxonomy": {
    "genre": "primary_genre",
    "length_scope": "novel/novella/short_story/etc",
    "narrative_structure": "three_act/hero_journey/etc",
    "pacing": "fast/moderate/slow",
    "tone": "dark/light/etc",
    "point_of_view": "first_person/third_limited/etc",
    "tense": "past/present",
    "setting_era": "contemporary/historical/future/etc",
    "themes": ["theme1", "theme2", "theme3"]
  }
}

IMPORTANT:
- The "text" field should be complete, polished premise text
- Include ALL taxonomy fields even if unchanged
- Focus changes on what the user requested
- Maintain narrative quality and coherence
- Temperature is 0.7 for creative but focused iteration

Write the revised premise now:
