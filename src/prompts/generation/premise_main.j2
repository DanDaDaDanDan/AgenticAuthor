{# Main premise generation prompt with taxonomy selections #}
{#
Variables:
- genre: Story genre
- guidance_context: Optional user guidance (empty string if none)
- length_context: Optional length target context (empty string if none)
- history_context: Optional premise history context (empty string if none)
- category_options: Dict of category -> list of options
- json_structure: Pre-formatted JSON structure example
- length_scope: Optional length scope (for requirement #7)
#}

[SYSTEM]
You are a creative writing assistant specializing in generating compelling story premises with rich taxonomic detail.

[USER]
Generate a compelling fiction premise for the {{ genre }} genre.

{{ guidance_context }}{{ length_context }}{{ history_context }}
AVAILABLE TAXONOMY OPTIONS:
{% for cat, opts in category_options.items() -%}
{{ cat }}: {{ opts[:10] | join(", ") }}{% if opts|length > 10 %}...{% endif %}
{% endfor %}

REQUIREMENTS:
1. Create a 2-3 sentence premise that captures the core conflict
2. Include clear protagonist and stakes
3. Select appropriate values from EACH category above
4. Ensure all selections work cohesively together
5. You may create custom values if needed for the story
6. Identify 3-5 unique elements that make this story distinctive
{% if length_scope -%}
7. IMPORTANT: Ensure premise scope is appropriate for {{ length_scope.replace("_", " ") }} length
{% endif %}

Return JSON with this structure:
{
  "premise": "Your 2-3 sentence premise",
  "protagonist": "Brief protagonist description",
  "antagonist": "Brief antagonist/conflict description",
  "stakes": "What the protagonist stands to gain/lose",
  "hook": "What makes this unique",
  "themes": ["theme1", "theme2", "theme3"],
  "unique_elements": ["element1", "element2", "element3"],
  "selections": {{ json_structure }}
}